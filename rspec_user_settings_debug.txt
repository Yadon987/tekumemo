........W, [2025-12-21T12:33:28.611673 #570987]  WARN -- omniauth: Attack prevented by OmniAuth::AuthenticityTokenProtection
E, [2025-12-21T12:33:28.612076 #570987] ERROR -- omniauth: (google_oauth2) Authentication failure! Forbidden: OmniAuth::AuthenticityError, Forbidden
F.....

Failures:

  1) ユーザー設定 設定画面の操作 Google連携を行い、その後解除できること
     Failure/Error: expect(page).to have_content("連携前の確認")
       expected to find text "連携前の確認" in "Routing Error\nNo route matches [GET] \"/users/auth/failure\"\nRails.root: /home/nukon999/workspace/tekumemo\nApplication Trace | Framework Trace | Full Trace\nRoutes\nRoutes match in priority from top to bottom\nHelper (Path / Url)\tHTTP Verb\tPath\tController#Action\tSource Location\nstats_coming_soon_index_path\tGET\t/stats_coming_soon/index(.:format)\t\nstats_coming_soon#index\n\t\nnew_user_session_path\tGET\t/users/sign_in(.:format)\t\ndevise/sessions#new\n\t\nuser_session_path\tPOST\t/users/sign_in(.:format)\t\ndevise/sessions#create\n\t\ndestroy_user_session_path\tDELETE\t/users/sign_out(.:format)\t\ndevise/sessions#destroy\n\t\nuser_google_oauth2_omniauth_authorize_path\tGET|POST\t/users/auth/google_oauth2(.:format)\t\nusers/omniauth_callbacks#passthru\n\t\nuser_google_oauth2_omniauth_callback_path\tGET|POST\t/users/auth/google_oauth2/callback(.:format)\t\nusers/omniauth_callbacks#google_oauth2\n\t\nnew_user_password_path\tGET\t/users/password/new(.:format)\t\ndevise/passwords#new\n\t\nedit_user_password_path\tGET\t/users/password/edit(.:format)\t\ndevise/passwords#edit\n\t\nuser_password_path\tPATCH\t/users/password(.:format)\t\ndevise/passwords#update\n\t\n\tPUT\t/users/password(.:format)\t\ndevise/passwords#update\n\t\n\tPOST\t/users/password(.:format)\t\ndevise/passwords#create\n\t\ncancel_user_registration_path\tGET\t/users/cancel(.:format)\t\nusers/registrations#cancel\n\t\nnew_user_registration_path\tGET\t/users/sign_up(.:format)\t\nusers/registrations#new\n\t\nedit_user_registration_path\tGET\t/users/edit(.:format)\t\nusers/registrations#edit\n\t\nuser_registration_path\tPATCH\t/users(.:format)\t\nusers/registrations#update\n\t\n\tPUT\t/users(.:format)\t\nusers/registrations#update\n\t\n\tDELETE\t/users(.:format)\t\nusers/registrations#destroy\n\t\n\tPOST\t/users(.:format)\t\nusers/registrations#create\n\t\nroot_path\tGET\t/\t\nhome#index\n\t\nwalks_path\tGET\t/walks(.:format)\t\nwalks#index\n\t\n\tPOST\t/walks(.:format)\t\nwalks#create\n\t\nnew_walk_path\tGET\t/walks/new(.:format)\t\nwalks#new\n\t\nedit_walk_path\tGET\t/walks/:id/edit(.:format)\t\nwalks#edit\n\t\nwalk_path\tGET\t/walks/:id(.:format)\t\nwalks#show\n\t\n\tPATCH\t/walks/:id(.:format)\t\nwalks#update\n\t\n\tPUT\t/walks/:id(.:format)\t\nwalks#update\n\t\n\tDELETE\t/walks/:id(.:format)\t\nwalks#destroy\n\t\nlogin_stamps_path\tGET\t/login_stamps(.:format)\t\nlogin_stamps#index\n\t\nrankings_path\tGET\t/rankings(.:format)\t\nrankings#index\n\t\nogp_image_rankings_user_path\tGET\t/rankings/users/:id/ogp_image(.:format)\t\nrankings/ogp_images#show {:format=>:jpg}\n\t\nstats_path\tGET\t/stats(.:format)\t\nstats#index\n\t\nstats_chart_data_path\tGET\t/stats/chart_data(.:format)\t\nstats#chart_data\n\t\ngoogle_fit_daily_data_path\tGET\t/google_fit/daily_data(.:format)\t\ngoogle_fit#daily_data\n\t\ngoogle_fit_status_path\tGET\t/google_fit/status(.:format)\t\ngoogle_fit#status\n\t\nmine_posts_path\tGET\t/posts/mine(.:format)\t\nposts#mine\n\t\npost_ogp_image_path\tGET\t/posts/:post_id/ogp_image(.:format)\t\nposts/ogp_images#show {:format=>:jpg}\n\t\npost_reactions_path\tPOST\t/posts/:post_id/reactions(.:format)\t\nreactions#create\n\t\npost_reaction_path\tDELETE\t/posts/:post_id/reactions/:id(.:format)\t\nreactions#destroy\n\t\nposts_path\tGET\t/posts(.:format)\t\nposts#index\n\t\n\tPOST\t/posts(.:format)\t\nposts#create\n\t\npost_path\tGET\t/posts/:id(.:format)\t\nposts#show\n\t\n\tDELETE\t/posts/:id(.:format)\t\nposts#destroy\n\t\nmark_as_read_notification_path\tPATCH\t/notifications/:id/mark_as_read(.:format)\t\nnotifications#mark_as_read\n\t\nmark_all_as_read_notifications_path\tPATCH\t/notifications/mark_all_as_read(.:format)\t\nnotifications#mark_all_as_read\n\t\nnotifications_path\tGET\t/notifications(.:format)\t\nnotifications#index\n\t\nweb_push_subscriptions_path\tPOST\t/web_push_subscriptions(.:format)\t\nweb_push_subscriptions#create\n\t\ndisconnect_google_user_path\tDELETE\t/users/:id/disconnect_google(.:format)\t\nusers#disconnect_google\n\t\nedit_user_path\tGET\t/users/:id/edit(.:format)\t\nusers#edit\n\t\nuser_path\tPATCH\t/users/:id(.:format)\t\nusers#update\n\t\n\tPUT\t/users/:id(.:format)\t\nusers#update\n\t\nadmin_root_path\tGET\t/admin(.:format)\t\nadmin/dashboard#index\n\t\nadmin_dashboard_path\tGET\t/admin/dashboard(.:format)\t\nadmin/dashboard#index\n\t\nadmin_users_path\tGET\t/admin/users(.:format)\t\nadmin/users#index\n\t\nadmin_user_path\tDELETE\t/admin/users/:id(.:format)\t\nadmin/users#destroy\n\t\nadmin_posts_path\tGET\t/admin/posts(.:format)\t\nadmin/posts#index\n\t\nadmin_post_path\tGET\t/admin/posts/:id(.:format)\t\nadmin/posts#show\n\t\n\tDELETE\t/admin/posts/:id(.:format)\t\nadmin/posts#destroy\n\t\nadmin_walks_path\tGET\t/admin/walks(.:format)\t\nadmin/walks#index\n\t\nadmin_walk_path\tGET\t/admin/walks/:id(.:format)\t\nadmin/walks#show\n\t\n\tDELETE\t/admin/walks/:id(.:format)\t\nadmin/walks#destroy\n\t\npublish_admin_announcement_path\tPATCH\t/admin/announcements/:id/publish(.:format)\t\nadmin/announcements#publish\n\t\nunpublish_admin_announcement_path\tPATCH\t/admin/announcements/:id/unpublish(.:format)\t\nadmin/announcements#unpublish\n\t\nadmin_announcements_path\tGET\t/admin/announcements(.:format)\t\nadmin/announcements#index\n\t\n\tPOST\t/admin/announcements(.:format)\t\nadmin/announcements#create\n\t\nnew_admin_announcement_path\tGET\t/admin/announcements/new(.:format)\t\nadmin/announcements#new\n\t\nedit_admin_announcement_path\tGET\t/admin/announcements/:id/edit(.:format)\t\nadmin/announcements#edit\n\t\nadmin_announcement_path\tGET\t/admin/announcements/:id(.:format)\t\nadmin/announcements#show\n\t\n\tPATCH\t/admin/announcements/:id(.:format)\t\nadmin/announcements#update\n\t\n\tPUT\t/admin/announcements/:id(.:format)\t\nadmin/announcements#update\n\t\n\tDELETE\t/admin/announcements/:id(.:format)\t\nadmin/announcements#destroy\n\t\nrails_health_check_path\tGET\t/up(.:format)\t\nrails/health#show\n\t\nconfirm_email_change_users_path\tGET\t/users/confirm_email_change(.:format)\t\nusers/omniauth_callbacks#confirm_email_change\n\t\nupdate_email_and_connect_users_path\tPOST\t/users/update_email_and_connect(.:format)\t\nusers/omniauth_callbacks#update_email_and_connect\n\t\nprivacy_path\tGET\t/privacy(.:format)\t\nstatic_pages#privacy\n\t\npwa_service_worker_path\tGET\t/service-worker(.:format)\t\nrails/pwa#service_worker\n\t\npwa_manifest_path\tGET\t/manifest(.:format)\t\nrails/pwa#manifest\n\t\nturbo_recede_historical_location_path\tGET\t/recede_historical_location(.:format)\t\nturbo/native/navigation#recede\n\t\nturbo_resume_historical_location_path\tGET\t/resume_historical_location(.:format)\t\nturbo/native/navigation#resume\n\t\nturbo_refresh_historical_location_path\tGET\t/refresh_historical_location(.:format)\t\nturbo/native/navigation#refresh\n\t\nrails_postmark_inbound_emails_path\tPOST\t/rails/action_mailbox/postmark/inbound_emails(.:format)\t\naction_mailbox/ingresses/postmark/inbound_emails#create\n\t\nrails_relay_inbound_emails_path\tPOST\t/rails/action_mailbox/relay/inbound_emails(.:format)\t\naction_mailbox/ingresses/relay/inbound_emails#create\n\t\nrails_sendgrid_inbound_emails_path\tPOST\t/rails/action_mailbox/sendgrid/inbound_emails(.:format)\t\naction_mailbox/ingresses/sendgrid/inbound_emails#create\n\t\nrails_mandrill_inbound_health_check_path\tGET\t/rails/action_mailbox/mandrill/inbound_emails(.:format)\t\naction_mailbox/ingresses/mandrill/inbound_emails#health_check\n\t\nrails_mandrill_inbound_emails_path\tPOST\t/rails/action_mailbox/mandrill/inbound_emails(.:format)\t\naction_mailbox/ingresses/mandrill/inbound_emails#create\n\t\nrails_mailgun_inbound_emails_path\tPOST\t/rails/action_mailbox/mailgun/inbound_emails/mime(.:format)\t\naction_mailbox/ingresses/mailgun/inbound_emails#create\n\t\nrails_conductor_inbound_emails_path\tGET\t/rails/conductor/action_mailbox/inbound_emails(.:format)\t\nrails/conductor/action_mailbox/inbound_emails#index\n\t\n\tPOST\t/rails/conductor/action_mailbox/inbound_emails(.:format)\t\nrails/conductor/action_mailbox/inbound_emails#create\n\t\nnew_rails_conductor_inbound_email_path\tGET\t/rails/conductor/action_mailbox/inbound_emails/new(.:format)\t\nrails/conductor/action_mailbox/inbound_emails#new\n\t\nrails_conductor_inbound_email_path\tGET\t/rails/conductor/action_mailbox/inbound_emails/:id(.:format)\t\nrails/conductor/action_mailbox/inbound_emails#show\n\t\nnew_rails_conductor_inbound_email_source_path\tGET\t/rails/conductor/action_mailbox/inbound_emails/sources/new(.:format)\t\nrails/conductor/action_mailbox/inbound_emails/sources#new\n\t\nrails_conductor_inbound_email_sources_path\tPOST\t/rails/conductor/action_mailbox/inbound_emails/sources(.:format)\t\nrails/conductor/action_mailbox/inbound_emails/sources#create\n\t\nrails_conductor_inbound_email_reroute_path\tPOST\t/rails/conductor/action_mailbox/:inbound_email_id/reroute(.:format)\t\nrails/conductor/action_mailbox/reroutes#create\n\t\nrails_conductor_inbound_email_incinerate_path\tPOST\t/rails/conductor/action_mailbox/:inbound_email_id/incinerate(.:format)\t\nrails/conductor/action_mailbox/incinerates#create\n\t\nrails_service_blob_path\tGET\t/rails/active_storage/blobs/redirect/:signed_id/*filename(.:format)\t\nactive_storage/blobs/redirect#show\n\t\nrails_service_blob_proxy_path\tGET\t/rails/active_storage/blobs/proxy/:signed_id/*filename(.:format)\t\nactive_storage/blobs/proxy#show\n\t\n\tGET\t/rails/active_storage/blobs/:signed_id/*filename(.:format)\t\nactive_storage/blobs/redirect#show\n\t\nrails_blob_representation_path\tGET\t/rails/active_storage/representations/redirect/:signed_blob_id/:variation_key/*filename(.:format)\t\nactive_storage/representations/redirect#show\n\t\nrails_blob_representation_proxy_path\tGET\t/rails/active_storage/representations/proxy/:signed_blob_id/:variation_key/*filename(.:format)\t\nactive_storage/representations/proxy#show\n\t\n\tGET\t/rails/active_storage/representations/:signed_blob_id/:variation_key/*filename(.:format)\t\nactive_storage/representations/redirect#show\n\t\nrails_disk_service_path\tGET\t/rails/active_storage/disk/:encoded_key/*filename(.:format)\t\nactive_storage/disk#show\n\t\nupdate_rails_disk_service_path\tPUT\t/rails/active_storage/disk/:encoded_token(.:format)\t\nactive_storage/disk#update\n\t\nrails_direct_uploads_path\tPOST\t/rails/active_storage/direct_uploads(.:format)\t\nactive_storage/direct_uploads#create\n\t\nRequest\nParameters:\n{\"message\"=>\"Forbidden\", \"strategy\"=>\"google_oauth2\"}\nToggle session dump\nToggle env dump\nResponse\nHeaders:\nNone"

     [Screenshot Image]: /home/nukon999/workspace/tekumemo/tmp/capybara/failures_r_spec_example_groups_nested_nested_2_google-_492.png


     # ./spec/system/user_settings_spec.rb:170:in `block (3 levels) in <top (required)>'

Top 10 slowest examples (18.49 seconds, 90.7% of total time):
  ユーザー設定 設定画面の操作 Google連携を行い、その後解除できること
    11.68 seconds ./spec/system/user_settings_spec.rb:147
  ユーザー設定 新規登録とログイン メールアドレスで新規登録し、ログインできること
    1.27 seconds ./spec/system/user_settings_spec.rb:15
  ユーザー設定 設定画面の操作 Google連携解除時にパスワードを間違えると解除できないこと
    0.84239 seconds ./spec/system/user_settings_spec.rb:202
  ユーザー設定 設定画面の操作 パスワードを変更できること（現在のパスワード必須）
    0.77934 seconds ./spec/system/user_settings_spec.rb:119
  ユーザー設定 設定画面の操作 確認用パスワードが一致しないと更新できないこと
    0.77434 seconds ./spec/system/user_settings_spec.rb:138
  ユーザー設定 設定画面の操作 現在のパスワードが間違っていると更新できないこと
    0.76278 seconds ./spec/system/user_settings_spec.rb:129
  ユーザー設定 設定画面の操作 プロフィール（名前・目標距離）を更新できること
    0.68239 seconds ./spec/system/user_settings_spec.rb:109
  ユーザー設定 新規登録とログイン 入力内容に不備がある場合 必須項目が未入力だと登録できず、エラーメッセージが表示されること
    0.64361 seconds ./spec/system/user_settings_spec.rb:29
  ユーザー設定 設定画面の操作 プロフィール更新（異常系） 名前を空にすると更新できないこと
    0.5718 seconds ./spec/system/user_settings_spec.rb:82
  ユーザー設定 設定画面の操作 プロフィール更新（異常系） 目標距離に不正な値（0以下）を入力すると更新できないこと
    0.48599 seconds ./spec/system/user_settings_spec.rb:88

Finished in 20.39 seconds (files took 0.99399 seconds to load)
14 examples, 1 failure

Failed examples:

rspec ./spec/system/user_settings_spec.rb:147 # ユーザー設定 設定画面の操作 Google連携を行い、その後解除できること

