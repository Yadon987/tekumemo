<%# OGP設定 %>
<% content_for :head do %>
  <meta property="og:title" content="ADVENTURE LOG - TekuMemo" />
  <meta property="og:description" content="<%= @post.body.present? ? @post.body.truncate(100) : '散歩の記録をチェックしよう！' %>" />
  <%# OGP画像のURLにキャッシュバスターと拡張子を追加 %>
  <meta property="og:image" content="<%= post_ogp_image_url(@post, format: :jpg, v: @post.updated_at.to_i) %>" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="<%= post_url(@post) %>" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="ADVENTURE LOG - TekuMemo" />
  <meta name="twitter:description" content="<%= @post.body.present? ? @post.body.truncate(100) : '散歩の記録をチェックしよう！' %>" />
  <meta name="twitter:image" content="<%= post_ogp_image_url(@post, format: :jpg, v: @post.updated_at.to_i) %>" />
<% end %>

<div class="container mx-auto px-4 py-8 min-h-screen flex items-center justify-center">
  <div class="max-w-2xl w-full bg-white dark:bg-[#1a0b2e] rounded-[2.5rem] shadow-[10px_10px_20px_#bebebe,-10px_-10px_20px_#ffffff] dark:shadow-[0_0_20px_rgba(168,85,247,0.4)] overflow-hidden border border-white/60 dark:border-purple-500/30 p-8">

    <!-- 戻るボタン -->
    <div class="mb-4">
      <% back_path = user_signed_in? ? posts_path : root_path %>
      <% back_text = user_signed_in? ? "タイムラインに戻る" : "トップページに戻る" %>
      <%= link_to back_path, class: "inline-flex items-center gap-2 text-slate-600 dark:text-purple-300 hover:text-purple-600 dark:hover:text-purple-200 transition font-bold" do %>
        <span class="material-symbols-outlined">arrow_back</span>
        <span class="text-sm"><%= back_text %></span>
      <% end %>
    </div>

    <h1 class="text-3xl font-bold mb-6 text-center text-slate-800 dark:text-purple-100">冒険の記録</h1>

    <div class="mb-8 relative group">
      <div class="absolute -inset-1 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-2xl blur opacity-25 group-hover:opacity-50 transition duration-1000 group-hover:duration-200"></div>
      <img src="<%= post_ogp_image_url(@post, format: :jpg) %>" alt="Adventure Log" class="relative w-full rounded-xl shadow-lg transform transition duration-500 hover:scale-[1.02]">
    </div>

    <% if @post.body.present? %>
      <p class="text-lg text-slate-600 dark:text-slate-300 mb-8 text-center font-medium leading-relaxed">
        "<%= @post.body %>"
      </p>
    <% end %>

    <div class="text-center space-y-4 max-w-md mx-auto">
      <% if @post.user_id == current_user&.id %>
        <%= link_to share_post_on_twitter_url(@post),
            target: "_blank",
            rel: "noopener noreferrer",
            class: "w-full bg-black text-white font-bold py-3 px-8 rounded-full transition-all duration-300 shadow-lg mb-4 flex items-center justify-center gap-2 ring-2 ring-cyan-400/50 shadow-[0_0_20px_rgba(6,182,212,0.5)] hover:shadow-[0_0_30px_rgba(6,182,212,0.8)] hover:ring-cyan-300 hover:scale-105 active:scale-95" do %>
          <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
          でシェアする
        <% end %>
        <br>
      <% end %>

      <% if user_signed_in? %>
        <%= link_to posts_path, class: "w-full bg-gradient-to-r from-cyan-600 to-blue-600 dark:from-[#0f172a] dark:to-[#1e3a8a] hover:from-cyan-500 hover:to-blue-500 dark:hover:from-[#1e293b] dark:hover:to-[#1e40af] text-white dark:text-cyan-100 font-bold py-4 px-10 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl dark:border dark:border-cyan-500/50 dark:shadow-[0_0_15px_rgba(6,182,212,0.3)] dark:hover:shadow-[0_0_25px_rgba(6,182,212,0.6)] dark:hover:border-cyan-400 hover:-translate-y-1 transform flex items-center justify-center gap-2" do %>
          <i class="fas fa-list"></i> <span>タイムラインを見る</span>
        <% end %>

        <%= link_to root_path, class: "w-full bg-gradient-to-r from-rose-600 to-red-600 dark:from-[#2e0f15] dark:to-[#450a0a] hover:from-rose-500 hover:to-red-500 dark:hover:from-[#4c0519] dark:hover:to-[#7f1d1d] text-white dark:text-rose-100 font-bold py-4 px-10 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl dark:border dark:border-rose-500/50 dark:shadow-[0_0_15px_rgba(244,63,94,0.3)] dark:hover:shadow-[0_0_25px_rgba(244,63,94,0.6)] dark:hover:border-rose-400 hover:-translate-y-1 transform flex items-center justify-center gap-2" do %>
          <i class="fas fa-home"></i> <span>ホームに戻る</span>
        <% end %>
      <% else %>
        <%= link_to new_user_session_path, class: "w-full bg-gradient-to-r from-purple-500 to-pink-500 dark:from-[#0f172a] dark:to-[#1e3a8a] hover:from-purple-600 hover:to-pink-600 dark:hover:from-[#1e293b] dark:hover:to-[#1e40af] text-white dark:text-cyan-100 font-bold py-4 px-10 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl dark:border dark:border-cyan-500/50 dark:shadow-[0_0_15px_rgba(6,182,212,0.3)] dark:hover:shadow-[0_0_25px_rgba(6,182,212,0.6)] dark:hover:border-cyan-400 hover:-translate-y-1 transform flex items-center justify-center gap-2" do %>
          <i class="fas fa-sign-in-alt"></i> <span>ログインして始める</span>
        <% end %>

        <%= link_to root_path, class: "w-full bg-gradient-to-r from-yellow-400 to-orange-500 dark:from-[#2e0f15] dark:to-[#450a0a] hover:from-yellow-500 hover:to-orange-600 dark:hover:from-[#4c0519] dark:hover:to-[#7f1d1d] text-white dark:text-rose-100 font-bold py-4 px-10 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl dark:border dark:border-rose-500/50 dark:shadow-[0_0_15px_rgba(244,63,94,0.3)] dark:hover:shadow-[0_0_25px_rgba(244,63,94,0.6)] dark:hover:border-rose-400 hover:-translate-y-1 transform flex items-center justify-center gap-2" do %>
          <i class="fas fa-play"></i> <span>冒険を始める</span>
        <% end %>
      <% end %>

      <p class="text-sm text-slate-400 dark:text-slate-500 mt-4">
        TekuMemo - 楽しく歩く、冒険する。
      </p>
    </div>
  </div>
</div>
