<!-- app/views/rankings/index.html.erb -->
<%# „É©„É≥„Ç≠„É≥„Ç∞ÁîªÈù¢„ÅÆ„ÉÄ„Éº„ÇØ„É¢„Éº„Éâ„Åß„ÅØ„ÄÅÂÖ±ÈÄö„ÅÆËÉåÊôØ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Ôºà„Éë„É´„ÇπÔºâ„ÅåÁã¨Ëá™ËÉåÊôØ„Å®Âπ≤Ê∏â„Åô„Çã„Åü„ÇÅÈùûË°®Á§∫„Å´„Åô„Çã %>
<style>
  html.dark body > .fixed.-z-10 {
    display: none !important;
  }
  /* „Éò„ÉÉ„ÉÄ„Éº„ÅÆÂ¢ÉÁïåÁ∑ö„ÇíÊ∂à„Åô */
  html.dark header {
    border-bottom-color: transparent !important;
  }
</style>
<div class="min-h-screen dark:bg-gradient-to-br dark:from-slate-900 dark:via-purple-800 dark:to-purple-900 pb-20 relative overflow-hidden">

  <!-- ËÉåÊôØ„ÅÆË£ÖÈ£æ -->
  <!-- „ÉÄ„Éº„ÇØ„É¢„Éº„ÉâÁî®ÔºàÂ∞ÇÁî®„Éç„Ç™„É≥ËÉåÊôØÔºâ -->
  <div class="hidden dark:block absolute inset-0 overflow-hidden pointer-events-none -z-10">
    <div class="absolute top-20 left-10 w-72 h-72 bg-purple-500/30 rounded-full mix-blend-multiply filter blur-3xl opacity-70"></div>
    <div class="absolute top-20 right-10 w-72 h-72 bg-pink-500/30 rounded-full mix-blend-multiply filter blur-3xl opacity-70"></div>
    <div class="absolute -bottom-8 left-20 w-72 h-72 bg-blue-500/30 rounded-full mix-blend-multiply filter blur-3xl opacity-70"></div>
  </div>

  <!-- „Éò„ÉÉ„ÉÄ„Éº„Ç®„É™„Ç¢ÔºàPCÁî®„ÅÆ„ÅøË°®Á§∫Ôºâ -->
  <div class="hidden md:block relative z-10 pt-8 pb-6 px-4 text-center">
    <div class="inline-block relative">
      <h1 class="text-4xl md:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 via-pink-500 to-orange-500 dark:from-yellow-300 dark:via-pink-300 dark:to-purple-300 tracking-tight drop-shadow-sm dark:drop-shadow-2xl">
        <%= t('rankings.index.title') %>
      </h1>
      <div class="absolute -top-6 -right-8 text-4xl animate-bounce">üèÜ</div>
      <div class="absolute -bottom-2 -left-6 text-3xl animate-spin-slow">‚ú®</div>
    </div>
    <p class="text-slate-600 dark:text-purple-200 text-sm mt-3 font-bold tracking-wide"><%= t('rankings.index.subtitle') %></p>

    <!-- „É™„Ç¢„É´„Çø„Ç§„É†Êõ¥Êñ∞„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº -->
    <div class="mt-4 flex items-center justify-center gap-2 text-xs text-slate-500 dark:text-purple-300">
      <span class="relative flex h-2 w-2">
        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
        <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
      </span>
      <span><%= period_label_ja(@period) %><%= t('rankings.index.list_title') %></span>
      <span class="text-slate-400 dark:text-purple-400"><%= t('rankings.index.update_frequency') %></span>
    </div>
  </div>

  <!-- ÊúüÈñìÂàá„ÇäÊõø„Åà„Çø„ÉñÔºà„É¨„Çπ„Éù„É≥„Ç∑„Éñ„Éû„Éº„Ç∏„É≥Ôºâ -->
  <div class="px-6 mt-6 md:mt-0 mb-6 md:mb-8 relative z-10">
    <div class="bg-[#fdfbf7] dark:bg-slate-800/50 dark:backdrop-blur-xl p-1.5 rounded-full shadow-[inset_6px_6px_12px_rgba(166,175,195,0.2),inset_-6px_-6px_12px_rgba(255,255,255,0.8)] dark:shadow-[0_0_30px_rgba(168,85,247,0.3)] border border-white/50 dark:border-purple-500/30 flex justify-between items-center max-w-md mx-auto">
      <% [
        { id: 'daily', label: t('rankings.index.tabs.daily'), icon: 'üìÖ' },
        { id: 'monthly', label: t('rankings.index.tabs.monthly'), icon: 'üìä' },
        { id: 'yearly', label: t('rankings.index.tabs.yearly'), icon: 'üåü' }
      ].each do |tab| %>
        <%= link_to rankings_path(period: tab[:id]),
            data: { turbo_frame: "_top" },
            class: "flex-1 text-center py-2 px-3 rounded-full text-xs font-bold transition-all duration-300 relative overflow-hidden group #{
              @period == tab[:id] ?
              'text-purple-700 dark:text-white bg-white dark:bg-gradient-to-r dark:from-purple-600 dark:to-pink-600 shadow-[4px_4px_8px_rgba(166,175,195,0.2),-4px_-4px_8px_rgba(255,255,255,0.9)] dark:shadow-[0_0_20px_rgba(168,85,247,0.5)]' :
              'text-slate-400 dark:text-purple-300 hover:text-slate-600 dark:hover:text-white hover:-translate-y-0.5 dark:hover:bg-slate-700/50'
            }" do %>
          <span class="relative z-10 flex items-center justify-center gap-1">
            <span class="text-base"><%= tab[:icon] %></span>
            <%= tab[:label] %>
          </span>
        <% end %>
      <% end %>
    </div>
  </div>

  <!-- Ëá™ÂàÜ„ÅÆ„Çπ„Ç≥„Ç¢„Ç´„Éº„Éâ -->
  <div class="px-4 mb-8 sticky top-4 z-20 max-w-2xl mx-auto w-full">
    <% if @my_rank %>
      <div class="relative group">
        <!-- „ÉÄ„Éº„ÇØ„É¢„Éº„ÉâÁî®„Ç∞„É≠„Éº -->
        <div class="hidden dark:block absolute -inset-1 bg-gradient-to-r from-purple-600 via-pink-600 to-purple-600 rounded-[2rem] blur-lg opacity-75 group-hover:opacity-100 transition animate-pulse"></div>

        <div class="relative bg-white dark:bg-gradient-to-br dark:from-slate-800 dark:to-slate-900 rounded-[2rem] p-6 border border-gray-200 dark:border-purple-500/30 shadow-lg dark:shadow-2xl backdrop-blur-xl">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-4">
              <div class="relative">
                <div class="w-16 h-16 rounded-2xl bg-gradient-to-br <%= @my_rank <= 3 ? 'from-yellow-300 to-orange-400 dark:from-yellow-400 dark:to-orange-500' : 'from-purple-400 to-pink-400 dark:from-purple-500 dark:to-pink-500' %> flex flex-col items-center justify-center shadow-[inset_-2px_-2px_5px_rgba(255,255,255,0.7),inset_2px_2px_5px_rgba(0,0,0,0.1)] dark:shadow-lg transform group-hover:scale-110 transition-transform leading-none">
                  <span class="text-3xl font-black text-white drop-shadow-md"><%= @my_rank %></span>
                  <span class="text-[10px] font-bold text-white/90 uppercase"><%= ordinal_suffix(@my_rank) %></span>
                </div>
                <% if @my_rank <= 3 %>
                  <div class="absolute -top-2 -right-2 text-2xl animate-bounce">üëë</div>
                <% end %>
              </div>

              <div>
                <p class="text-xs text-purple-400 dark:text-purple-300 font-bold uppercase tracking-wider mb-1"><%= t('rankings.index.your_rank.title') %></p>
                <p class="text-2xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 dark:from-yellow-300 dark:to-pink-300">
                  <%= @my_rank %> <span class="text-sm"><%= t('rankings.index.your_rank.rank_suffix') %></span>
                </p>
                <% if @my_rank <= 10 %>
                  <p class="text-[10px] text-green-600 dark:text-green-400 font-bold mt-1">üî• <%= t('rankings.index.your_rank.top_10') %></p>
                <% end %>
              </div>
            </div>

            <div class="text-right">
              <p class="text-xs text-purple-400 dark:text-purple-300 font-bold uppercase tracking-wider mb-1"><%= t('rankings.index.your_rank.distance') %></p>
              <p class="text-3xl font-black text-slate-700 dark:text-white">
                <%= number_with_precision(@my_distance, precision: 1) %>
              </p>
              <p class="text-xs text-slate-500 dark:text-purple-400"><%= t('rankings.index.your_rank.unit') %></p>

              <% if @distance_to_top > 0 %>
                <p class="text-[10px] text-orange-500 dark:text-yellow-400 mt-2 font-bold">
                  üéØ <%= t('rankings.index.your_rank.distance_to_top') %>: <%= number_with_precision(@distance_to_top * 1000, precision: 0) %>m
                </p>
              <% end %>
            </div>
          </div>

          <!-- „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº -->
          <% if @my_rank && @my_rank > 1 %>
            <% next_rank_distance = @rankings[@my_rank - 2]&.total_distance.to_f %>
            <% distance_needed = next_rank_distance - @my_distance %>
            <% if distance_needed > 0 %>
              <div class="mt-4 pt-4 border-t border-purple-100 dark:border-purple-500/30">
                <div class="flex justify-between text-xs text-slate-500 dark:text-purple-300 mb-2">
                  <span><%= t('rankings.index.your_rank.distance_to_next') %></span>
                  <span class="font-bold text-orange-600 dark:text-yellow-400"><%= number_with_precision(distance_needed * 1000, precision: 0) %>m</span>
                </div>
                <div class="h-3 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden shadow-inner">
                  <div class="h-full bg-gradient-to-r from-purple-400 to-pink-400 dark:from-purple-500 dark:to-pink-500 rounded-full transition-all duration-500 dark:shadow-lg dark:shadow-purple-500/50"
                       style="width: <%= [(@my_distance / next_rank_distance * 100), 100].min %>%"></div>
                </div>
              </div>
            <% end %>
          <% end %>

          <!-- X„Åß„Ç∑„Çß„Ç¢„Éú„Çø„É≥ -->
          <div class="mt-5">
            <%= link_to share_ranking_on_twitter_url(user: current_user, rank: @my_rank, distance: @my_distance * 1000, period: @period),
                target: "_blank",
                rel: "noopener noreferrer",
                class: "w-full md:w-auto md:px-10 md:min-w-[200px] mx-auto flex items-center justify-center gap-2 px-4 py-2.5 rounded-full bg-black dark:bg-white text-white dark:text-black text-sm font-bold hover:bg-gray-800 dark:hover:bg-gray-200 transition transform active:scale-95 shadow-md" do %>
              <svg class="w-3.5 h-3.5 fill-current" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
              „É©„É≥„Ç≠„É≥„Ç∞„Çí„Ç∑„Çß„Ç¢
            <% end %>
          </div>
        </div>
      </div>
    <% else %>
      <!-- „É©„É≥„Ç≠„É≥„Ç∞Â§ñ -->
      <div class="relative group">
        <div class="hidden dark:block absolute -inset-1 bg-gradient-to-r from-orange-600 to-red-600 rounded-[2rem] blur-lg opacity-50 group-hover:opacity-75 transition"></div>

        <div class="relative bg-orange-50 dark:bg-gradient-to-br dark:from-slate-800 dark:to-slate-900 rounded-[2rem] p-4 border-2 border-white dark:border-orange-500/50 shadow-lg dark:shadow-2xl">
          <div class="flex items-center gap-3">
            <div class="text-3xl animate-bounce">üî•</div>
            <div class="flex-1">
              <p class="text-base font-black text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-red-500 dark:from-orange-300 dark:to-red-300 mb-0.5">
                <%= t('rankings.index.empty.challenge') %>
              </p>
              <p class="text-xs text-slate-600 dark:text-purple-200">
                <%= period_label_ja(@period) %>: <span class="font-bold text-slate-800 dark:text-white"><%= number_with_precision(@my_distance, precision: 1) %>km</span>
              </p>
              <p class="text-[10px] text-orange-500 dark:text-orange-400 mt-1">üí™ <%= t('rankings.index.empty.cheer') %></p>
            </div>
            <div class="text-2xl">‚ö°</div>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Ë°®ÂΩ∞Âè∞Ôºà„Éà„ÉÉ„Éó3Â∞ÇÁî®„Ç®„É™„Ç¢Ôºâ -->
  <% if @rankings.present? %>
    <div class="px-4 mb-8 max-w-2xl mx-auto">
      <h2 class="text-center text-xl font-black text-slate-700 dark:text-purple-200 mb-6 flex items-center justify-center gap-2">
        <span>üèÜ</span> <%= t('rankings.index.podium') %> <span>üèÜ</span>
      </h2>

      <div class="flex items-end justify-center gap-4 sm:gap-6 md:gap-12 mb-8 w-full max-w-lg mx-auto">
        <!-- 2‰Ωç -->
        <div class="flex-1 min-w-0 text-center transform hover:scale-105 transition-transform <%= 'opacity-0' unless @rankings[1] %>">
          <% if second = @rankings[1] %>
            <div class="relative inline-block mb-2">
              <% if second.avatar_url.present? && second.use_google_avatar %>
                <%= image_tag second.avatar_url, class: "relative w-10 h-10 md:w-16 md:h-16 rounded-full border-2 md:border-4 border-slate-300 dark:border-slate-400 shadow-[4px_4px_8px_rgba(166,175,195,0.4),-4px_-4px_8px_rgba(255,255,255,0.8)] dark:shadow-xl object-cover" %>
              <% else %>
                <div class="relative w-10 h-10 md:w-16 md:h-16 rounded-full border-2 md:border-4 border-slate-300 dark:border-slate-400 bg-blue-500 flex items-center justify-center text-white font-bold text-lg md:text-2xl shadow-[4px_4px_8px_rgba(166,175,195,0.4),-4px_-4px_8px_rgba(255,255,255,0.8)] dark:shadow-xl">
                  <%= second.name.to_s[0, 2]&.upcase || "?" %>
                </div>
              <% end %>
              <div class="absolute -bottom-2 -right-2 text-xl md:text-3xl">ü•à</div>
            </div>
            <p class="text-slate-700 dark:text-white font-bold text-[10px] md:text-sm truncate px-1"><%= second.name.presence || "No Name" %></p>
            <p class="text-slate-500 dark:text-slate-300 text-[10px] md:text-xs"><%= number_with_precision(second.total_distance, precision: 1) %>km</p>
            <div class="mt-2 h-24 md:h-40 w-[90%] mx-auto bg-gradient-to-t from-slate-300 to-slate-200 dark:from-slate-400 dark:to-slate-500 rounded-t-xl md:rounded-t-2xl border-2 md:border-4 border-white dark:border-slate-300 shadow-[4px_4px_8px_rgba(166,175,195,0.3)] dark:shadow-lg flex items-start justify-center pt-2 md:pt-4">
              <span class="text-xl md:text-3xl font-black text-slate-600 dark:text-white drop-shadow-sm">2</span>
            </div>
          <% end %>
        </div>

        <!-- 1‰Ωç -->
        <div class="flex-1 min-w-0 text-center transform hover:scale-110 transition-transform <%= 'opacity-0' unless @rankings[0] %>">
          <% if first = @rankings[0] %>
            <div class="relative inline-block mb-2">
              <% if first.avatar_url.present? && first.use_google_avatar %>
                <%= image_tag first.avatar_url, class: "relative w-14 h-14 md:w-20 md:h-20 rounded-full border-2 md:border-4 border-yellow-400 shadow-[6px_6px_12px_rgba(250,204,21,0.4),-6px_-6px_12px_rgba(255,255,255,0.9)] dark:shadow-2xl object-cover" %>
              <% else %>
                <div class="relative w-14 h-14 md:w-20 md:h-20 rounded-full border-2 md:border-4 border-yellow-400 bg-blue-500 flex items-center justify-center text-white font-bold text-xl md:text-3xl shadow-[6px_6px_12px_rgba(250,204,21,0.4),-6px_-6px_12px_rgba(255,255,255,0.9)] dark:shadow-2xl">
                  <%= first.name.to_s[0, 2]&.upcase || "?" %>
                </div>
              <% end %>
              <div class="absolute -top-3 left-1/2 -translate-x-1/2 text-2xl md:text-4xl animate-bounce">üëë</div>
              <div class="absolute -bottom-2 -right-2 text-2xl md:text-4xl drop-shadow-lg">ü•á</div>
            </div>
            <p class="text-yellow-700 dark:text-yellow-300 font-black text-xs md:text-base truncate px-1">üåü <%= first.name.presence || "No Name" %></p>
            <p class="text-yellow-600 dark:text-yellow-200 text-xs md:text-sm font-bold"><%= number_with_precision(first.total_distance, precision: 1) %>km</p>
            <div class="mt-2 h-32 md:h-52 w-[90%] mx-auto bg-gradient-to-t from-yellow-400 via-yellow-300 to-yellow-200 dark:from-yellow-400 dark:via-yellow-500 dark:to-yellow-600 rounded-t-xl md:rounded-t-2xl border-2 md:border-4 border-white dark:border-yellow-300 shadow-[6px_6px_12px_rgba(250,204,21,0.4),-6px_-6px_12px_rgba(255,255,255,0.9)] dark:shadow-[0_0_30px_rgba(250,204,21,0.5)] flex items-start justify-center pt-2 md:pt-4">
              <span class="text-2xl md:text-4xl font-black text-yellow-800 dark:text-white drop-shadow-sm">1</span>
            </div>
          <% end %>
        </div>

        <!-- 3‰Ωç -->
        <div class="flex-1 min-w-0 text-center transform hover:scale-105 transition-transform <%= 'opacity-0' unless @rankings[2] %>">
          <% if third = @rankings[2] %>
            <div class="relative inline-block mb-2">
              <% if third.avatar_url.present? && third.use_google_avatar %>
                <%= image_tag third.avatar_url, class: "relative w-10 h-10 md:w-16 md:h-16 rounded-full border-2 md:border-4 border-orange-300 dark:border-orange-400 shadow-[4px_4px_8px_rgba(251,146,60,0.4),-4px_-4px_8px_rgba(255,255,255,0.8)] dark:shadow-xl object-cover" %>
              <% else %>
                <div class="relative w-10 h-10 md:w-16 md:h-16 rounded-full border-2 md:border-4 border-orange-300 dark:border-orange-400 bg-blue-500 flex items-center justify-center text-white font-bold text-lg md:text-2xl shadow-[4px_4px_8px_rgba(251,146,60,0.4),-4px_-4px_8px_rgba(255,255,255,0.8)] dark:shadow-xl">
                  <%= third.name.to_s[0, 2]&.upcase || "?" %>
                </div>
              <% end %>
              <div class="absolute -bottom-2 -right-2 text-xl md:text-3xl">ü•â</div>
            </div>
            <p class="text-slate-700 dark:text-white font-bold text-[10px] md:text-sm truncate px-1"><%= third.name.presence || "No Name" %></p>
            <p class="text-orange-600 dark:text-orange-300 text-[10px] md:text-xs"><%= number_with_precision(third.total_distance, precision: 1) %>km</p>
            <div class="mt-2 h-16 md:h-28 w-[90%] mx-auto bg-gradient-to-t from-orange-300 to-orange-200 dark:from-orange-400 dark:to-orange-500 rounded-t-xl md:rounded-t-2xl border-2 md:border-4 border-white dark:border-orange-300 shadow-[4px_4px_8px_rgba(251,146,60,0.3)] dark:shadow-lg flex items-start justify-center pt-2 md:pt-4">
              <span class="text-xl md:text-3xl font-black text-orange-700 dark:text-white drop-shadow-sm">3</span>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>

  <!-- „É©„É≥„Ç≠„É≥„Ç∞„É™„Çπ„ÉàÔºà4‰Ωç‰ª•ÈôçÔºâ -->
  <div class="px-4 max-w-2xl mx-auto space-y-3">
    <% if @rankings.size > 3 %>
      <h3 class="text-lg font-bold text-slate-700 dark:text-purple-200 mb-4 flex items-center gap-2">
        <span class="text-2xl">
          <%= case @period
              when 'daily' then 'üìÖ'
              when 'monthly' then 'üìä'
              when 'yearly' then 'üåü'
              else 'üìä'
              end %>
        </span>
        <%= t('rankings.index.list_title') %>
      </h3>
    <% end %>

    <% last_distance = nil %>
    <% current_rank = 0 %>
    <% @rankings.each_with_index do |user, index| %>
      <% # Ë∑ùÈõ¢„ÅåÁï∞„Å™„ÇãÂ†¥Âêà„ÅÆ„ÅøÈ†Ü‰Ωç„ÇíÊõ¥Êñ∞ÔºàÂêåË∑ùÈõ¢„Å™„ÇâÁ∂≠ÊåÅÔºâ %>
      <% # Â∞èÊï∞ÁÇπ‰ª•‰∏ã„ÅÆË™§Â∑Æ„ÇíËÄÉÊÖÆ„Åó„Å¶ÊØîËºÉ %>
      <% distance = user.total_distance.to_f.round(2) %>
      <% if distance != last_distance %>
        <% current_rank = index + 1 %>
      <% end %>
      <% last_distance = distance %>

      <% rank = current_rank %>
      <% next if index < 3 # ‰∏ä‰Ωç3Âêç„ÅØÂà•Êû†Ë°®Á§∫„Å†„Åå„ÄÅÈ†Ü‰ΩçË®àÁÆó„ÅÆ„Åü„ÇÅ„Å´„É´„Éº„Éó„ÅØÂõû„Åô %>
      <% is_current_user = user.id == current_user.id %>

      <div class="relative group transition-all duration-300 hover:-translate-y-1">
        <!-- „ÉÄ„Éº„ÇØ„É¢„Éº„ÉâÁî®„Ç∞„É≠„ÉºÔºàËá™ÂàÜ„ÅÆÂ†¥ÂêàÔºâ -->
        <% if is_current_user %>
          <div class="hidden dark:block absolute -inset-0.5 bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl blur opacity-75"></div>
        <% end %>

        <div class="relative bg-white dark:bg-slate-800/70 dark:backdrop-blur-sm rounded-2xl p-4 border border-gray-200 dark:border-<%= is_current_user ? 'purple-500/30' : 'purple-500/30' %> shadow-lg dark:shadow-xl hover:shadow-xl dark:hover:shadow-2xl transition-shadow flex items-center gap-4 <%= 'ring-2 ring-purple-400 ring-offset-2 ring-offset-[#fdfbf7] dark:ring-0' if is_current_user %>">

          <!-- È†Ü‰Ωç„Éê„ÉÉ„Ç∏ -->
          <div class="w-12 h-12 flex-shrink-0 flex items-center justify-center rounded-xl shadow-[inset_-2px_-2px_5px_rgba(255,255,255,0.7),inset_2px_2px_5px_rgba(0,0,0,0.1)] dark:shadow-inner <%= rank <= 10 ? 'bg-gradient-to-br from-purple-300 to-pink-300 dark:from-purple-500 dark:to-pink-500' : 'bg-slate-100 dark:bg-slate-700' %>">
            <span class="text-xl font-black <%= rank <= 10 ? 'text-purple-700 dark:text-white' : 'text-slate-600 dark:text-slate-300' %>"><%= rank %></span>
          </div>

            <!-- „É¶„Éº„Ç∂„ÉºÊÉÖÂ†± -->
          <div class="flex-1 min-w-0 flex items-center gap-3">
            <% if user.avatar_url.present? && user.use_google_avatar %>
              <%= image_tag user.avatar_url, class: "w-10 h-10 rounded-full border-2 border-slate-200 dark:border-white/20 shadow-sm object-cover" %>
            <% else %>
              <div class="w-10 h-10 rounded-full bg-blue-500 border-2 border-blue-400 shadow-sm flex items-center justify-center text-white font-bold text-sm">
                <%= user.name.to_s[0, 2]&.upcase || "?" %>
              </div>
            <% end %>

            <div class="flex-1 min-w-0">
              <p class="font-bold <%= is_current_user ? 'text-purple-700 dark:text-purple-300' : 'text-slate-700 dark:text-white' %> truncate">
                <%= user.name.presence || "No Name" %>
              </p>
              <div class="flex items-center gap-2 mt-0.5">
                <% if rank <= 10 %>
                  <p class="text-[10px] text-purple-500 dark:text-purple-400 font-bold">TOP 10</p>
                <% end %>
                <% if is_current_user %>
                  <span class="text-[10px] bg-purple-500 text-white px-2 py-0.5 rounded-full shadow-sm whitespace-nowrap"><%= t('rankings.index.you') %></span>
                <% end %>
              </div>
            </div>
          </div>

          <!-- Ë∑ùÈõ¢ -->
          <div class="text-right">
            <span class="block text-2xl font-black <%= is_current_user ? 'text-purple-600 dark:text-purple-300' : 'text-slate-700 dark:text-white' %> group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors">
              <%= number_with_precision(user.total_distance, precision: 1) %>
            </span>
            <span class="text-[10px] text-slate-400 dark:text-slate-500 font-bold uppercase tracking-wider">km</span>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Á©∫Áä∂ÊÖã -->
    <% if @rankings.empty? %>
      <div class="relative group">
        <div class="hidden dark:block absolute -inset-1 bg-gradient-to-r from-purple-600 to-pink-600 rounded-[2.5rem] blur-xl opacity-30"></div>

        <div class="relative bg-white dark:bg-slate-800/70 dark:backdrop-blur-sm rounded-[2.5rem] p-12 border-2 border-white dark:border-slate-700/50 shadow-[14px_14px_28px_rgba(166,175,195,0.25),-14px_-14px_28px_rgba(255,255,255,0.9)] dark:shadow-lg text-center">
          <div class="text-7xl mb-6 animate-bounce">üçÉ</div>
          <p class="text-slate-700 dark:text-white font-black text-2xl mb-3"><%= t('rankings.index.empty.title') %></p>
          <p class="text-slate-500 dark:text-purple-300 text-sm mb-8"><%= t('rankings.index.empty.subtitle') %></p>
          <%= link_to t('rankings.index.empty.action'), new_walk_path,
              class: "inline-block px-8 py-4 bg-gradient-to-r from-purple-500 to-pink-500 dark:from-purple-600 dark:to-pink-600 text-white font-bold rounded-full shadow-lg hover:scale-110 hover:shadow-xl dark:hover:shadow-2xl dark:hover:shadow-purple-500/50 transition-all" %>
        </div>
      </div>
    <% end %>
  </div>

  <div class="h-20"></div>
</div>


