# SNS 機能（みんなの投稿）実装計画書

## 1. 概要

「てくメモ」に、ユーザー同士が緩やかにつながり、散歩のモチベーションを高め合うための SNS 機能（みんなの投稿）を実装します。
「本気度の高い SNS」ではなく、「散歩のついでに誰かの気配を感じる」「ポジティブなリアクションだけで繋がる」ような、心理的安全性の高いコミュニティを目指します。

## 2. コンセプト

- **テーマ:** モダン、リッチ、ポップ、散歩
- **距離感:** 「周りの目を意識する」程度の緩い繋がり。コメント機能は排除し、リアクションのみで肯定的なフィードバックを行う。
- **デザイン:** 既存のダークモード対応デザインを踏襲し、プレミアム感のある UI を提供する。

## 3. 機能要件

### 3.1 タイムライン（みんなの投稿）

- 全ユーザーの投稿を時系列順（新しい順）に表示する。
- ページネーション機能を実装（1 ページあたり 10〜20 件程度）。
- **タブ構成:**
  1.  **みんなの投稿:** 全ユーザーの投稿を表示（デフォルト）。
  2.  **フォロー中の人の投稿:** （※今回は UI のみ実装し、機能は「実装予定」とする）。
  3.  **投稿履歴:** 自分の過去の投稿のみを表示。

### 3.2 投稿機能

- **内容:** テキスト（140〜200 文字程度を想定）。
- **散歩記録との連携:** 任意の散歩記録（Walk）を選択して、その内容（距離や時間）を投稿に添付できる機能を将来的に想定（今回はまずはテキストのみ、または直近の散歩データを自動参照する形を検討）。
- **編集・削除:** 自分の投稿に対してのみ可能。

### 3.3 リアクション機能

- 投稿に対して、以下の 4 種類のリアクションを行える。
  - 👍 (いいね)
  - ❤️ (すてき)
  - 💡 (ひらめき/なるほど)
  - 🌸 (季節/美しい/おつかれ)
- 1 人が 1 つの投稿に対して複数の種類のリアクションを可能にするか、1 回のみにするかは「緩さ」を重視して「何度でも押せる（または種類ごとに 1 回）」とする。今回は**各種類 1 回ずつ ON/OFF 可能**とする。
- 誰がリアクションしたかは詳細を見なくても数だけで満足感を得られるようにする。

### 3.4 ユーザープロフィール（簡易）

- 投稿者のアバターと名前を表示。
- 名前をクリックすると、そのユーザーの「投稿履歴」が見られる（あるいはプロフィールモーダルが表示される）と良い。

## 4. データモデル設計

### 新規モデル

#### `Post`

ユーザーの投稿を管理します。

- `body`: text (投稿本文)
- `user_id`: references (投稿者)
- `walk_id`: references (紐付ける散歩記録, nullable)
- `timestamps`

#### `Reaction`

リアクションを管理します。

- `user_id`: references (リアクションした人)
- `post_id`: references (対象の投稿)
- `kind`: integer (0: like, 1: heart, 2: bulb, 3: flower)
- ユニーク制約: `[user_id, post_id, kind]` の組み合わせで一意にする。

#### `Relationship` (将来用/基盤のみ作成)

フォロー関係を管理します。

- `follower_id`: references (User)
- `followed_id`: references (User)

## 5. 散歩を面白くする機能の提案

### A. 「散歩ストリーク（連続記録）バッジ」

投稿時に、そのユーザーが何日連続で散歩（または投稿）しているかを自動で判定し、投稿カードに「🔥 3 日連続」のような小さなバッジを表示します。
-> **効果:** 「明日も歩こう」というモチベーションに直結します。

### B. 「今日の天気/気分タグ」

投稿時に、天気（晴れ、雨、曇り）や気分（最高、まあまあ、疲れた）をアイコンで選択し、投稿に付与します。
-> **効果:** テキストを書くのが面倒な時でも、アイコンだけで今の状態をシェアできます。

### C. 「すれ違い（ニアミス）演出」

（位置情報を使わない範囲で）同じ都道府県や、同じ時間帯に散歩していたユーザーの投稿をハイライト表示（枠の色を変えるなど）します。
-> **効果:** 「今、同じ空の下で歩いている人がいる」という連帯感を生みます。

## 6. 実装ステップ

1.  **モデル作成:** `Post`, `Reaction` モデルの作成とマイグレーション。
2.  **コントローラー・ルート:** `posts` リソースの設定。
3.  **ビュー実装:**
    - `posts/index.html.erb`: タイムライン表示（提供された HTML をベースに実装）。
    - `_post.html.erb`: 投稿カードのコンポーネント化。
    - `_form.html.erb`: 投稿フォーム（モーダルまたはページ上部）。
4.  **リアクション機能:** Turbo Frames を使って、ページ遷移なしでリアクション数を更新する。
5.  **仕上げ:** デザイン調整、レスポンシブ対応、空の状態（Empty State）の作成。

---

**確認事項:**
上記の内容で実装を進めてよろしいでしょうか？
特に「散歩を面白くする機能」の中で、今回採用したいものがあれば教えてください。
