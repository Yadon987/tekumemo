# 🚶 てくてくメモリア

**働き盛り世代の散歩習慣化を支援するコミュニティ型 Web アプリ**

[![デモサイト](https://img.shields.io/badge/DEMO-てくてくメモリア-blue?style=for-the-badge)](https://tekumemo.onrender.com)

https://github.com/user-attachments/assets/43e280c3-2bbe-4e0c-8960-45760f61e1c7

---

## � 開発背景と解決したい課題

> **「散歩は健康に良いと分かっているのに、続かない」**

私自身も含め、働き盛り世代の多くが運動不足を認識しながらも、以下の理由で散歩習慣を継続できていない課題に着目しました。

### 😣 ユーザーが抱える課題

1. **達成感の欠如**: ただ歩くだけでは成果が見えにくく、「頑張り」を感じられない。
2. **モチベーション低下**: 一人で黙々と続けるのは孤独で、飽きが来やすい。
3. **記録の手間**: わざわざアプリを開いて「開始」「終了」を押すのは面倒で続かない。

### 💡 このアプリのアプローチ

| 課題               | 解決策                                                        |
| ------------------ | ------------------------------------------------------------- |
| **達成感**         | Google Fit 連携による自動計測と、ログインスタンプによる可視化 |
| **モチベーション** | 「応援」「すごいね」などの多様なリアクションとランキング機能  |
| **手間ゼロ**       | 歩数や消費カロリーはバックグラウンドで自動取得                |

---

## 🏗️ インフラ構成図

```mermaid
graph TB
    subgraph Client
        Browser[ブラウザ (PC/SP)]
    end

    subgraph Render
        Rails[Rails 7.2 (Web Server)]
    end

    subgraph External Services
        Supabase[(Supabase PostgreSQL)]
        GoogleFit[Google Fit API]
        OpenWeather[OpenWeatherMap API]
        Cloudinary[Cloudinary (画像保存)]
    end

    Browser -- HTTPS --> Rails
    Rails -- Read/Write --> Supabase
    Rails -- Sync Steps --> GoogleFit
    Rails -- Get Weather --> OpenWeather
    Rails -- Upload/Serve --> Cloudinary
```

---

## ✨ 主要機能

### 🏃 散歩記録 & Google Fit 連携

手動入力の手間を省くため、Google Fit API と連携。バックグラウンドで計測された歩数・距離・消費カロリー・活動時間を自動的にアプリに取り込みます。

### 📅 継続ログインスタンプ

ラジオ体操カードのような懐かしさを感じるスタンプカード機能。毎日のログイン自体を「小さな成功体験」に変え、習慣化をサポートします。

### 👏 コミュニティ＆多彩なリアクション

単なる「いいね」だけでなく、「応援してる！」「お疲れ様！」「すごい！」など、状況に合わせた 12 種類のリアクションを用意。言葉にしなくても気持ちが伝わる設計にこだわりました。

### ☀️ 天気予報連携

OpenWeatherMap API と連携し、散歩の計画を立てやすくしています。

---

## 🛠️ 技術スタック

### バックエンド

| 技術           | バージョン | 選定理由                                                                       |
| -------------- | ---------- | ------------------------------------------------------------------------------ |
| **Ruby**       | 3.2.2      | 可読性が高く、保守しやすいコードベースを維持するため                           |
| **Rails**      | 7.2.x      | Hotwire が標準搭載されており、SPA のような UX を少人数で効率的に開発できるため |
| **PostgreSQL** | 15         | 本番環境(Supabase)との親和性が高く、JSONB 型などの拡張性も考慮したため         |

### フロントエンド

| 技術                             | 選定理由                                                                                         |
| -------------------------------- | ------------------------------------------------------------------------------------------------ |
| **Hotwire** <br>(Turbo/Stimulus) | React/Vue のような複雑なビルド環境を持たずに、部分更新やモーダルなどのリッチな UI を実現するため |
| **Tailwind CSS**                 | クラス名命名のコストを無くし、デザインシステムに基づいた一貫性のある UI を高速に構築するため     |

### インフラ・その他

| 技術         | 選定理由                                                                                       |
| ------------ | ---------------------------------------------------------------------------------------------- |
| **Render**   | デプロイの手軽さとコストパフォーマンス、GitHub 連携による継続的デプロイ(CD)のため              |
| **Supabase** | 高機能な PostgreSQL 環境をマネージドで利用でき、将来的なリアルタイム機能への拡張も見込めるため |
| **Docker**   | 開発メンバー間での環境差異を無くし、オンボーディングコストを下げるため                         |

---

## 💡 技術的なこだわりポイント

### 1. N+1 問題の徹底排除とパフォーマンス

開発段階から `Bullet` gem を導入し、N+1 問題を即座に検知・修正しています。特にランキングやタイムライン表示部分では `includes` や `counter_cache` を適切に使用し、レスポンス速度を維持しています。

### 2. テスト駆動による品質担保

個人開発でも品質を妥協せず、CI/CD を見据えたテスト環境を構築しました。

- **RSpec** による単体・結合テスト（計 325 ケース）
- **SimpleCov** によるカバレッジ計測（カバレッジ率 **74.6%** を維持）
- **RuboCop** によるコード規約の統一

### 3. セキュリティへの配慮

- `Brakeman` による静的解析で脆弱性をチェック
- 開発環境と本番環境でデータベース接続情報を厳格に分離（`.env`管理の徹底）

### 4. ユーザー体験（UX）の向上

- **ダークモード対応**: 早朝や夜間の散歩前後に見ることを想定し、目に優しい配色は必須要件としました。
- **レスポンス**: Hotwire(Turbo Stream)を活用し、ページ遷移を感じさせない高速な動作を実現しています。

---

---

## 📐 設計ドキュメント

### 🗺️ 画面遷移図 (Figma)

[![画面遷移図](https://i.gyazo.com/46f161ccd35179b545c2b700eeb17617.png)](https://www.figma.com/board/U1dqKDAMsI9lNTAEYcGTOV/FigJam-basics?node-id=0-1&p=f&t=ZDUfKhhX3F41N6dn-0)

> [Figma Board で見る](https://www.figma.com/board/U1dqKDAMsI9lNTAEYcGTOV/FigJam-basics?node-id=0-1&p=f&t=ZDUfKhhX3F41N6dn-0)

### 🗂️ ER 図 (dbdiagram.io)

[![ER図](https://i.gyazo.com/e7e5ef231e64ab355c1c605a2842cbac.png)](https://gyazo.com/e7e5ef231e64ab355c1c605a2842cbac)

> [dbdiagram.io で詳細を見る](https://dbdiagram.io/d/68f9ef31357668b7323f223e)

---

## ✅ 機能一覧・ロードマップ

<details>
<summary><strong>詳細な機能リストと優先度表（クリックして展開）</strong></summary>

### 機能候補と優先順位

| 優先度            | 技術要素                        | 目的                                                                        |
| :---------------- | :------------------------------ | :-------------------------------------------------------------------------- |
| **最優先（MVP）** | **CRUD 操作・DB 操作**          | 投稿、ユーザー認証・ログインなどのデータ永続化に必須                        |
| **最優先（MVP）** | **歩数記録・表示**              | メイン機能                                                                  |
| **最優先（MVP）** | **継続スタンプ + カレンダー**   | 習慣化の核機能。実装が比較的容易                                            |
| **最優先（MVP）** | **リアクション機能**            | コミュニティの基盤。多様な反応で継続モチベーション向上                      |
| **最優先（MVP）** | **非同期通信**                  | 投稿データの送受信、外部 API データ取得時の UX 向上                         |
| **最優先（MVP）** | **外部 API 連携（Google Fit）** | ユーザーの面倒なデータ入力の手間を省く                                      |
| **最優先（MVP）** | **外部 API 連携（天気予報）**   | ユーザーが散歩計画を立てるための実用性                                      |
| **最優先（MVP）** | **Google ログイン**             | ログインの手間を減らす                                                      |
| **高優先**        | **フォロー機能**                | 継続的なコミュニティ形成。モチベーション維持の核                            |
| **中優先**        | **ランキング機能**              | ゲーミフィケーション要素                                                    |
| **中優先**        | **Google マップ API 連携**      | 歩行距離表示など、高度な UX を実現                                          |
| **低優先**        | **通知機能**                    | 継続利用を促すためのプッシュ通知                                            |
| **低優先**        | **グラフ機能**                  | ユーザー体験を向上させるための可視化                                        |
| **低優先**        | **継続スタンプ補填**            | 雨などで連続ログインが止まらないように運動ガチャでスタンプを補填            |
| **低優先**        | **フォロー機能**                | 継続的なコミュニティ形成。本来は高優先度だがユーザーが少ないうちは低優先度  |
| **低優先**        | **アチーブメント機能**          | 目標達成の可視化 一つ一つリッチなデザインを考え実装する時間がかかるためボツ |

### 将来実装予定

- 位置情報の取得・ルート表示
- 歩数と距離の自動計算
- 散歩リマインダー通知
- グラフ・統計表示

</details>

---

## 💻 開発環境のセットアップ

採用担当者様やチームメンバーが環境を構築する手順です。

<details>
<summary><strong>詳細な手順を表示（クリックして展開）</strong></summary>

### 前提条件

- Docker Engine / Docker Compose

### 手順

```bash
# 1. リポジトリのクローン
git clone https://github.com/Yadon987/tekumemo.git
cd tekumemo

# 2. コンテナのビルドと起動
docker compose up -d

# 3. データベース作成とマイグレーション
docker exec tekumemo-web bash -c "bundle exec rails db:create db:migrate db:seed"
```

アプリは `http://localhost:3000` で起動します。

### テストの実行

Docker 環境内で全テストを実行し、カバレッジを出力するスクリプトを用意しています。

```bash
chmod +x bin/test_all.sh
./bin/test_all.sh
```

### ⚠️ 重要: 環境変数の管理

このプロジェクトでは、**開発環境と本番環境で異なる環境変数ファイルを使用**します：

- **`.env`** - 開発環境用（ローカル Docker 環境）
  - `DATABASE_URL`は**設定しないでください**
- **`.env.production`** - 本番環境用（Supabase 使用）
  - 本番デプロイ時のみ使用

</details>

---

## 👤 今後の展望

- **Google マップ連携**: 歩いたルートを地図上に描画し、視覚的な振り返りを強化
- **プッシュ通知**: 雨雲レーダーと連動した「散歩チャンス通知」の実装
- **Google Cloud 審査**: Google Fit 連携の本番利用承認の取得（現在はテストユーザーのみ）

---

## 📝 変更履歴

v1.3 ER 図の作成と仕様変更

v1.4 アプリ正式名称を『てくてくメモリア』に変更

v1.5 MVP リリースのドキュメント整理
